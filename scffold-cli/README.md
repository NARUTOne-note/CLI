# 脚手架CLI

> 利用CLI，方便开发者可以有选择的使用脚手架，方便团队代码风格统一; `create-react-app` 和 `vue-cli`，它们可以帮助我们”搭建-运行-构建“项目。

[《大前端进阶 Node.js》系列 P6必备脚手架/CI构建能力](https://juejin.im/post/5e7a22a8e51d4526d87c99ed?utm_source=gold_browser_extension)

***

## 优点

- 减少重复性工作

- 规范项目开发目录结构

- 统一团队统一开发风格，便于跨团队合作，以及后期维护，降低新人上手成本

- 提供一键前端项目的创建、配置、本地开发、插件扩展等功能，让开发者更多时间专注于业务

## 思路

![cli](./cli.png)

**CLI 搭建项目**：

- 根据用户输入生成配置文件
- 下载指定项目模板
- 在目标目录生成新项目

**CLI 运行项目**：

- 本地启动预览
- 热更新
- 语法、代码规范检测

**部署项目**：

- 代码推送至仓库
- 前端部署的管理后台去进行发布

> 上面的部署部分，只是实现的方式之一，有的需要自动触发打包、发布上线的场景，采用的是去 Gitlab 下一个 Webhook，Gitlab 收到用户 push 代码的操作后，会给前端部署服务中心那边打请求，然后按照事先配置好的进行打包、发布上线。

## 依赖

- `babel-cli/babel-env`：语法转换工具，有了它我们在开发脚手架的时候就可以使用 ES6 语法了，不要问我为什么要用 ES6，因为它神奇而伟大
- `commander`：命令行工具，有了它我们就可以读取命令行命令，知道用户想要做什么了[Commander.js 中文文档](https://juejin.im/post/5cefb981e51d454f73356ce9)
- `inquirer`： 交互式命令行工具，给用户提供一个漂亮的界面和提出问题流的方式
- `download-git-repo`：下载远程模板工具，负责下载远程仓库的模板项目
- `chalk`：颜色插件，用来修改命令行输出样式，通过颜色区分 info、error 日志，清晰直观
- `ora`：用于显示加载中的效果，类似于前端页面的 loading 效果，像下载模板这种耗时的操作，有了 loading 效果可以提示用户正在进行中，请耐心等待
- `log-symbols`：日志彩色符号，用来显示√ 或 × 等的图标

## 脚手架项目吗模板

> 在脚手架执行创建项目命令的时候，直接将准备好的模板拷贝到目标目录下。

**存放位置**:

- `和脚手架打包在一起`，在安装脚手架的时候就会将项目模板存放在全局目录下了，这种方式每次创建项目的时候都是从本地拷贝的速度很快，但是项目模板自身升级比较困难。
- `将项目模板存在远端仓库（比如 gitlab 仓库）`，这种方式每次创建项目的时候都是通过某个地址动态下载的，项目模板更新方便。

## 开发

- 修改 package.json 中的 **bin 参数**，专门放置用户的自定义命令，指定可执行文件的位置，bin 里的命令是可执行命令，模块安装的时候如果是全局安装，则 npm 会为 bin 中配置的文件创建一个全局软连接，在命令行工具里可以直接执行。

- 修改 package.json 中的 **scripts 参数**，指定可执行命令，实时编译脚本，让 node 能够识别并执行
